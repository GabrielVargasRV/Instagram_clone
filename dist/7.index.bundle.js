(self.webpackChunkwhatsappv2=self.webpackChunkwhatsappv2||[]).push([[7],{8007:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var r=n(6156),a=n(2137),c=n(4699),s=n(7757),o=n.n(s),l=n(7294),u=n(5977),i=n(2051),m=n(4494),p=n(4593),d=n(96);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const h=(0,m.$j)((function(e){return{userData:e.userData}}),(function(e){return{}}))((function(e){var t=e.userData,n=(0,u.UO)().id,r=(0,l.useState)(null),s=(0,c.Z)(r,2),m=s[0],f=s[1],h=(0,l.useState)(!1),v=(0,c.Z)(h,2),g=v[0],b=v[1],k=(0,l.useState)(""),O=(0,c.Z)(k,2),y=O[0],w=O[1],x=(0,l.useState)(!0),P=(0,c.Z)(x,2),j=P[0],N=P[1],Z=function(){var e=(0,a.Z)(o().mark((function e(){var r,a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=10;break}return b(!1),a=(r=m).likes.indexOf(t.username),r.likes.splice(a,1),f(r),e.next=8,i.db.collection("posts").doc(n).collection("likes").doc(t.username).delete();case 8:e.next=16;break;case 10:return b(!0),(c=m).likes.push(t.username),f(c),e.next=16,i.db.collection("posts").doc(n).collection("likes").doc(t.username).set({username:t.username});case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=(0,a.Z)(o().mark((function e(r){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),a={text:y,username:t.username,userPhoto:t.photoURL,id:y},e.next=4,i.db.collection("posts").doc(n).collection("comments").add(a);case 4:w(""),(c=m.comments).push(a),f(E(E({},m),{},{comments:c}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,a.Z)(o().mark((function e(){var r,a,c,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.db.collection("posts").doc(n).get();case 2:return r=e.sent,e.next=5,i.db.collection("posts").doc(n).collection("likes").get();case 5:return a=e.sent,c=[],a.docs&&a.docs.forEach((function(e){c.push(e.id)})),e.next=10,i.db.collection("posts").doc(n).collection("comments").get();case 10:s=e.sent,l=[],s.docs&&s.docs.forEach((function(e){l.push(E({id:e.id},e.data()))})),c.includes(t.username)&&b(!0),f(E(E({},r.data()),{},{likes:c,comments:l})),N(!1);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,l.useEffect)((function(){S()}),[]),j?l.createElement(d.Z,null):l.createElement(l.Fragment,null,l.createElement(p.q,null,l.createElement("title",null,"Instagram - Post")),m?l.createElement("div",{className:"Post-page"},l.createElement("div",{className:"post-page_l",style:{backgroundImage:"url(".concat(m.photo,")")}}),l.createElement("div",{className:"post-page_r"},l.createElement("div",{className:"post-page_header"},l.createElement("img",{src:m.userPhoto,alt:""}),l.createElement("p",null,m.username)),l.createElement("div",{className:"post-page_comments"},m.comments.length&&m.comments.map((function(e){return l.createElement("div",{className:"post-page_comment",key:e.id},l.createElement("img",{src:e.userPhoto,alt:""}),l.createElement("div",null,l.createElement("p",null,l.createElement("strong",null,e.username)),l.createElement("p",null,e.text)))}))),l.createElement("div",{className:"post-page_footer"},l.createElement("div",{className:"buttons"},g?l.createElement("i",{onClick:Z,className:"fas fa-heart"}):l.createElement("i",{onClick:Z,className:"far fa-heart"}),l.createElement("i",{className:"far fa-comment"})),l.createElement("p",null,l.createElement("strong",null,m.likes.length," likes")),l.createElement("div",{className:"add-comment"},l.createElement("form",{onSubmit:D},l.createElement("textarea",{cols:"30",placeholder:"Add a comment...",value:y,onChange:function(e){return w(e.target.value)}}),l.createElement("button",{type:"submit"},"Post")))))):l.createElement("div",null,"Loading..."))}))}}]);