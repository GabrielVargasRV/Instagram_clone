(self.webpackChunkwhatsappv2=self.webpackChunkwhatsappv2||[]).push([[362],{8362:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var r=n(2137),l=n(4699),c=n(7757),a=n.n(c),o=n(7294),s=n(5977),u=n(4593),i=n(4494),m=n(96),f=n(6156),d=n(2051);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const h=function(e){var t=e.postInfo,n=e.handlePostModal,c=(0,o.useState)(null),s=(0,l.Z)(c,2),u=s[0],i=s[1],m=function(){var e=(0,r.Z)(a().mark((function e(){var n,r,l,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.db.collection("posts").doc(t.id).collection("likes").get();case 2:return n=e.sent,r=[],n.docs&&n.docs.forEach((function(e){r.push(e.id)})),e.next=7,d.db.collection("posts").doc(t.id).collection("comments").get();case 7:l=e.sent,c=[],l.docs&&l.docs.forEach((function(e){c.push(E({id:e.id},e.data()))})),i(E(E({},t),{},{likes:r,comments:c}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){m()}),[]),u?o.createElement("button",{onClick:function(){return n(u)},className:"Profile-post",style:{backgroundImage:"url(".concat(u.photo,")")}},o.createElement("div",{className:"content"},o.createElement("div",null,o.createElement("i",{className:"fas fa-heart"}),o.createElement("p",null,u.likes.length)),o.createElement("div",null,o.createElement("i",{class:"fas fa-comment"}),o.createElement("p",null,u.comments.length)))):o.createElement("div",{class:"lds-spinner"},o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null),o.createElement("div",null))};var v=n(5072);const g=(0,i.$j)((function(e){return{userData:e.userData}}),(function(e){return{}}))((function(e){var t=e.userData,n=(0,s.UO)().username,c=(0,s.k6)(),i=(0,o.useState)(null),f=(0,l.Z)(i,2),d=f[0],p=f[1],E=(0,o.useState)(!0),g=(0,l.Z)(E,2),b=g[0],w=g[1],k=(0,o.useState)(!1),y=(0,l.Z)(k,2),x=y[0],P=y[1],O=(0,o.useState)(!0),Z=(0,l.Z)(O,2),j=Z[0],N=Z[1],C=(0,o.useState)(null),S=(0,l.Z)(C,2),D=S[0],I=S[1],L=function(){var e=(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.ZN)(n,t);case 2:P(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.IJ)(d.uid,n,t.uid,t.username);case 2:P(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,v.P4)(d,t).then((function(e){c.push("/inbox/".concat(e))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,r.Z)(a().mark((function e(n){var r,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,db.collection("posts").doc(n).collection("likes").get();case 2:if(r=e.sent,l=[],r.forEach((function(e){l.push(e.id)})),l.includes(t.username)){e.next=8;break}return e.next=8,db.collection("posts").doc(n).collection("likes").doc(t.username).set({username:t.username});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,r.Z)(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,db.collection("posts").doc(n).collection("likes").doc(t.username).delete();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,r.Z)(a().mark((function e(n,r){var l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={text:r,username:t.username,userPhoto:t.photoURL},e.next=3,db.collection("posts").doc(n).collection("comments").add(l);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),q=function(e){N(!j),I(e);var t=document.getElementById("post-modal");t.style.display=j?"block":"none"};return(0,o.useEffect)((function(){(0,v.Ai)(n,t.username).then((function(e){p(e),e.followers.forEach((function(e){e.username===t.username&&P(!0)})),w(!1)}))}),[]),b&&m.Z,o.createElement(o.Fragment,null,o.createElement(u.q,null,o.createElement("title",null,"Instagram - ",n)),o.createElement("div",{id:"post-modal",className:"post-modal-container"},o.createElement("button",{onClick:function(){return q(null)},className:"close-btn"},o.createElement("i",{class:"fas fa-times"})),D?o.createElement(PostModal,{postModalInfo:D,userData:t,addLike:R,disLike:F,addComment:_}):o.createElement("p",null,"Loading...")),d?o.createElement("div",{className:"Profile"},o.createElement("div",{className:"Profile-header"},o.createElement("div",{className:"Profile-header_left"},o.createElement("img",{src:d.photoURL,alt:""})),o.createElement("div",{className:"Profile-header_right"},o.createElement("div",null,o.createElement("h2",null,d.username),n!==t.username&&o.createElement("div",null,o.createElement("button",{onClick:U},"Messege"),x?o.createElement("button",{onClick:M},"Unfollow"):o.createElement("button",{onClick:L,style:{backgroundColor:"#0095f6",color:"white"}},"Follow"))),o.createElement("div",null,o.createElement("p",null,o.createElement("strong",null,d.posts.length)," posts"),o.createElement("p",null,o.createElement("strong",null,d.followers.length)," followers"),o.createElement("p",null,o.createElement("strong",null,d.following.length)," following")),o.createElement("div",null,o.createElement("p",null,d.bio)))),d.posts.length?o.createElement("div",{className:"Profile-posts"},d.posts.map((function(e){return o.createElement(h,{postInfo:e,handlePostModal:q})}))):o.createElement("div",{style:{height:"50vh",display:"grid",placeItems:"center",marginTop:"10px",borderRadius:"4px",backgroundColor:"#fff"}},o.createElement("h2",null,"Start capturing and sharing your moments."))):o.createElement(m.Z,null))}))}}]);