(self.webpackChunkwhatsappv2=self.webpackChunkwhatsappv2||[]).push([[202],{4990:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(4699),a=n(7294),c=n(3727);const s=function(e){var t=e.postModalInfo,n=e.userData,s=e.addLike,o=e.disLike,l=e.addComment,u=(0,a.useState)(!1),i=(0,r.Z)(u,2),m=i[0],d=i[1],p=(0,a.useState)(""),f=(0,r.Z)(p,2),E=f[0],h=f[1],v=function(){if(m){d(!1);var e=t,r=e.likes.indexOf(n.username);e.likes.splice(r,1),setPost(e),o(t.id)}else{d(!0);var a=post;a.likes.push(username),setPost(a),s(t.id)}};return(0,a.useEffect)((function(){t.likes.includes(n.username)&&d(!0)}),[]),a.createElement("div",{className:"post-modal"},a.createElement("div",{className:"photo",style:{backgroundImage:"url(".concat(t.photo,")")}}),a.createElement("div",{className:"post-modal-rigth"},a.createElement("div",{className:"post-modal-header"},a.createElement("img",{src:t.userPhoto,alt:""}),a.createElement(c.rU,{to:"profile/".concat(t.username),className:"link"},t.username)),a.createElement("div",{className:"post-modal-comments"},t.comments.map((function(e){return a.createElement("div",{key:e.id},a.createElement("img",{src:e.userPhoto,alt:""}),a.createElement("p",null,a.createElement("strong",null,a.createElement(c.rU,{className:"link",to:"profile/".concat(e.username)},e.username),"  "),e.text))}))),a.createElement("div",{className:"post-modal-addcomment"},a.createElement("div",null,m?a.createElement("i",{onClick:v,className:"fas fa-heart"}):a.createElement("i",{onClick:v,className:"far fa-heart"}),a.createElement("i",{className:"far fa-comment"})),a.createElement("p",null,a.createElement("strong",null,t.likes.length," likes")),a.createElement("form",{onSubmit:function(e){e.preventDefault(),t.comments.push({id:1,text:E,userPhoto:n.photoURL,username:n.username}),l(t.id,E),h("")}},a.createElement("textarea",{cols:"30",value:E,onChange:function(e){return h(e.target.value)},placeholder:"Add a comment"}),a.createElement("button",{type:"submit"},"Post")))))}},1202:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Z});var r=n(6156),a=n(2137),c=n(4699),s=n(7757),o=n.n(s),l=n(7294),u=n(4593),i=n(4494),m=n(3727),d=n(5977),p=n(2051);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){var t=e.postInfo,n=e.username,r=e.addLike,s=e.disLike,u=e.addComment,i=e.handlePostModal,d=(0,l.useState)(!1),f=(0,c.Z)(d,2),h=f[0],v=f[1],g=(0,l.useState)({}),b=(0,c.Z)(g,2),k=b[0],y=b[1],w=(0,l.useState)(""),O=(0,c.Z)(w,2),N=O[0],x=O[1],P=function(){var e=(0,a.Z)(o().mark((function e(){var r,a,c,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.db.collection("posts").doc(t.id).collection("likes").get();case 2:return r=e.sent,a=[],r.docs&&r.docs.forEach((function(e){a.push(e.id)})),e.next=7,p.db.collection("posts").doc(t.id).collection("comments").get();case 7:c=e.sent,s=[],c.docs&&c.docs.forEach((function(e){s.push(E({id:e.id},e.data()))})),a.includes(n)&&v(!0),y(E(E({},t),{},{likes:a,comments:s}));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){if(h){v(!1);var e=k,a=e.likes.indexOf(n);e.likes.splice(a,1),y(e),s(t.id)}else{v(!0);var c=k;c.likes.push(n),y(c),r(t.id)}};return(0,l.useEffect)((function(){P()}),[]),l.createElement(l.Fragment,null,k.username&&l.createElement("div",{className:"post",key:k.id},l.createElement("div",{className:"post-header"},l.createElement("img",{src:k.userPhoto,alt:""}),l.createElement(m.rU,{className:"link",to:"/profile/".concat(k.username)},l.createElement("p",null,k.username))),l.createElement("img",{className:"post-img",src:k.photo,alt:""}),l.createElement("div",{className:"post-footer"},l.createElement("div",{className:"buttons"},h?l.createElement("i",{onClick:Z,className:"fas fa-heart"}):l.createElement("i",{onClick:Z,className:"far fa-heart"}),l.createElement("i",{className:"far fa-comment"})),l.createElement("p",null,l.createElement("strong",null,k.likes.length," likes")),l.createElement("p",null,l.createElement("strong",null,k.username)," ",k.caption.length<45?k.caption:"".concat(k.caption.substr(0,42),"...")),k.comments.length?l.createElement("div",null,k.comments.length>=2&&l.createElement("p",{style:{cursor:"pointer"},onClick:function(){return i(k)}},"View all ",k.comments.length," comments"),l.createElement("p",null,l.createElement("strong",null,k.comments[0].username)," "," ",k.comments[0].text.length<35?k.comments[0].text:"".concat(k.comments[0].text.substr(0,32),"..."))):l.createElement("div",null),l.createElement("div",{className:"add-comment"},l.createElement("form",{onSubmit:function(e){e.preventDefault(),u(k.id,N),x("")}},l.createElement("textarea",{name:"comment",cols:"30",placeholder:"Add a comment...",value:N,onChange:function(e){return x(e.target.value)}}),l.createElement("button",{type:"submit"},"Post"))))))};const v=l.memo(h);var g=n(4990),b=n(676);var k=n(2961);function y(e){return function(e){if(Array.isArray(e))return(0,b.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,k.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w=n(5072);const O=(0,i.$j)((function(e){return{userData:e.userData}}),(function(e){return{}}))((function(e){var t=e.userData,n=(0,l.useState)([]),r=(0,c.Z)(n,2),s=r[0],u=r[1],i=function(){var e=(0,a.Z)(o().mark((function e(){var n,r,a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.following.length){e.next=9;break}return e.next=3,p.db.collection("userData").where("username","not-in",t.following).limit(5).get();case 3:n=e.sent,r=[],n.docs.forEach((function(e){e.data().uid!==t.uid&&r.push(e.data())})),u(r),e.next=15;break;case 9:return e.next=11,p.db.collection("userData").limit(5).get();case 11:a=e.sent,c=[],a.docs.forEach((function(e){e.data().uid!==t.uid&&c.push(e.data())})),u(c);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,a.Z)(o().mark((function e(n,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=s).splice(r,1),console.log(a),u(y(a)),(0,w.ZN)(n,t);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,l.useEffect)((function(){i()}),[]),l.createElement("div",{className:"suggestions-container"},l.createElement("p",{className:"title"},"Suggestion for you"),l.createElement("div",null,s?l.createElement("div",null,s.map((function(e,t){return l.createElement("div",{className:"sugg-user",key:e.uid},l.createElement("div",null,l.createElement("img",{src:e.photoURL,alt:""}),l.createElement(m.rU,{className:"link",to:"/profile/".concat(e.username)},l.createElement("p",null,e.username))),l.createElement("button",{onClick:function(){return d(e.username,t)}},"Follow"))}))):l.createElement("div",null)))}));var N=n(96);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Z=(0,i.$j)((function(e){return{userData:e.userData}}),(function(e){return{}}))((function(e){var t=e.userData,n=(0,d.k6)(),r=(0,l.useState)([]),s=(0,c.Z)(r,2),i=s[0],f=s[1],E=(0,l.useState)(!0),h=(0,c.Z)(E,2),b=h[0],k=h[1],y=(0,l.useState)(!0),w=(0,c.Z)(y,2),x=w[0],Z=w[1],j=(0,l.useState)(null),S=(0,c.Z)(j,2),D=S[0],C=S[1],L=function(){var e=(0,a.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,p.db.collection("posts").where("username","==","Instagram").get();case 3:if(e.sent.docs.forEach((function(e){n.push(P({id:e.id},e.data()))})),!t.following.length){e.next=10;break}return e.next=8,p.db.collection("posts").where("username","in",t.following).get();case 8:e.sent.docs.forEach((function(e){n.push(P({id:e.id},e.data()))}));case 10:f(n),k(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,a.Z)(o().mark((function e(n){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.db.collection("posts").doc(n).collection("likes").get();case 2:if(r=e.sent,a=[],r.forEach((function(e){a.push(e.id)})),a.includes(t.username)){e.next=8;break}return e.next=8,p.db.collection("posts").doc(n).collection("likes").doc(t.username).set({username:t.username});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.db.collection("posts").doc(n).collection("likes").doc(t.username).delete();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,a.Z)(o().mark((function e(n,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={text:r,username:t.username,userPhoto:t.photoURL},e.next=3,p.db.collection("posts").doc(n).collection("comments").add(a);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=function(e){Z(!x),C(e);var t=document.getElementById("post-modal");t.style.display=x?"block":"none"};return(0,l.useEffect)((function(){t?L():n.push("/")}),[t]),b?l.createElement(N.Z,null):l.createElement(l.Fragment,null,l.createElement("div",{id:"post-modal",className:"post-modal-container"},l.createElement("button",{onClick:function(){return M(null)},className:"close-btn"},l.createElement("i",{class:"fas fa-times"})),D?l.createElement(g.Z,{postModalInfo:D,userData:t,addLike:I,disLike:U,addComment:A}):l.createElement("p",null,"Loading...")),l.createElement(u.q,null,l.createElement("title",null,"Instagram")),t?l.createElement("div",{className:"Home"},l.createElement("button",{className:"createpost-btn",onClick:function(){return n.push("/create-post")}},"Create post"),l.createElement("div",{className:"posts"},i.length&&i.map((function(e){return l.createElement(v,{handlePostModal:M,postInfo:e,username:t.username,disLike:U,addLike:I,key:e.id,addComment:A})}))),l.createElement("div",{className:"suggestions"},l.createElement("div",{className:"sugg-header"},l.createElement("div",null,l.createElement("img",{src:t.photoURL,alt:""}),l.createElement("span",null,l.createElement(m.rU,{className:"link",to:"/profile/".concat(t.username)},l.createElement("p",{className:"username"},t.username)),l.createElement("p",{className:"name"},t.name))),l.createElement("button",{onClick:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.I.signOut();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},"Switch")),l.createElement(O,null))):l.createElement(N.Z,null))}))}}]);